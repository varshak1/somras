jQuery(document).ready(function(){function t(t){var a,e="",s=jQuery(".dslca-post-option-image",t);s.each(function(){a=jQuery(this),imageID=a.data("id"),e+=imageID+" "}),jQuery(".dslca-post-options-field-file",t).val(e)}function a(a){var e=a.closest(".dslca-post-option");a.remove(),t(e)}jQuery(".dslca-post-options-field-datepicker").datepicker(),jQuery(document).on("click",".dslca-post-option-image-remove",function(){a(jQuery(this).closest(".dslca-post-option-image"))}),jQuery(".dslca-post-option-field-files .dslca-post-options-images").length&&(jQuery(".dslca-post-option-field-files .dslca-post-options-images").sortable({update:function(){t(jQuery(this).closest(".dslca-post-option"))}}),jQuery(".dslca-post-options-images").disableSelection());var e;jQuery(".dslca-post-option-add-file-hook").click(function(){var t=jQuery(this),a=jQuery(this).closest(".dslca-post-option"),s=jQuery(".dslca-post-options-field-file",a),i=jQuery(".dslca-post-option-image",a),o=!1;t.data("multiple")&&(o=!0),e=wp.media.frames.file_frame=wp.media({title:"Choose File",button:{text:"Send to option"},multiple:o}),e.on("select",function(){if(o){attachments=e.state().get("selection").toJSON(),attachmentVal="";for(var t=0;t<attachments.length;t++)attachment=attachments[t],attachmentVal+=attachment.id+" ",a.find(".dslca-post-options-images").append('<div class="dslca-post-option-image" data-id="'+attachment.id+'"><div class="dslca-post-option-image-inner"><img src="'+attachment.url+'" /><span class="dslca-post-option-image-remove">x</span></div></div>');s.val(s.val()+attachmentVal)}else attachment=e.state().get("selection").first().toJSON(),"image"==attachment.type?i.length?i.find("img").attr("src",attachment.url):a.find(".dslca-post-options-images").html('<div class="dslca-post-option-image" data-id="'+attachment.id+'"><div class="dslca-post-option-image-inner"><img src="'+attachment.url+'" /></div><span class="dslca-post-option-image-remove">x</span></div>'):i.length?i.find("strong").text(attachment.filename):a.find(".dslca-post-options-images").html('<div class="dslca-post-option-image" data-id="'+attachment.id+'"><div class="dslca-post-option-image-inner"><strong>'+attachment.filename+"</strong></div></div>"),s.val(attachment.id)}),e.open()})});